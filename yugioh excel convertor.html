<!DOCTYPE html>
<html>
<head>
    <title>Excel to JavaScript Converter</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <h2>Upload Excel File</h2>
    <input type="file" id="excelFile" accept=".xlsx, .xls">
    <div id="output"></div>

    <script>
    document.getElementById('excelFile').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Get the first sheet
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                
                // Convert to JSON - this should get all rows
                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                
                console.log('Total rows converted:', jsonData.length);
                console.log('First few rows:', jsonData.slice(0, 3));
                
                // Generate JavaScript code
                const jsCode = `const data = ${JSON.stringify(jsonData, null, 2)};`;
                
                // Display results
                document.getElementById('output').innerHTML = 
                    `<h3>Converted ${jsonData.length} rows:</h3>` +
                    `<pre><code>${jsCode}</code></pre>`;
                    
            } catch (error) {
                console.error('Error:', error);
                alert('Error processing file. Please make sure it\'s a valid Excel file.');
            }
        };
        
        reader.readAsArrayBuffer(file);
    });
    </script>
</body>
</html>